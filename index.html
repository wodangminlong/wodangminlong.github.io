<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/long.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/long.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/long.png">
  <link rel="mask-icon" href="/images/long.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"wodangminlong.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="胜利垂青于有准备的人">
<meta property="og:type" content="website">
<meta property="og:title" content="知足常乐">
<meta property="og:url" content="https://wodangminlong.github.io/index.html">
<meta property="og:site_name" content="知足常乐">
<meta property="og:description" content="胜利垂青于有准备的人">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="dml">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://wodangminlong.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>知足常乐</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">知足常乐</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wodangminlong.github.io/2021/12/17/java-jar_xms_xmx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="dml">
      <meta itemprop="description" content="胜利垂青于有准备的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知足常乐">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/17/java-jar_xms_xmx/" class="post-title-link" itemprop="url">Java启动jar包并设置占用内存大小</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-12-17 15:33:25 / 修改时间：15:32:59" itemprop="dateCreated datePublished" datetime="2021-12-17T15:33:25+08:00">2021-12-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/java%E5%90%AF%E5%8A%A8jar%E5%8C%85%E8%AE%BE%E7%BD%AE%E5%86%85%E5%AD%98%E5%A4%A7%E5%B0%8F/" itemprop="url" rel="index"><span itemprop="name">java启动jar包设置内存大小</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="今天听开发说开发服务器内存满了导致新启动的服务在服务器启动一会就会被自动杀死-用top命令看了下java项目的内存占用过高-准备使用启动命令控制内存使用情况"><a href="#今天听开发说开发服务器内存满了导致新启动的服务在服务器启动一会就会被自动杀死-用top命令看了下java项目的内存占用过高-准备使用启动命令控制内存使用情况" class="headerlink" title="今天听开发说开发服务器内存满了导致新启动的服务在服务器启动一会就会被自动杀死,用top命令看了下java项目的内存占用过高,准备使用启动命令控制内存使用情况"></a>今天听开发说开发服务器内存满了导致新启动的服务在服务器启动一会就会被自动杀死,用top命令看了下java项目的内存占用过高,准备使用启动命令控制内存使用情况</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar $1 -Xms512m -Xmx1024m &amp;</span><br></pre></td></tr></table></figure>
<h3 id="最开始在需要启动的jar包后边加上-Xms和-Xmx参数-结果发现不起作用。"><a href="#最开始在需要启动的jar包后边加上-Xms和-Xmx参数-结果发现不起作用。" class="headerlink" title="最开始在需要启动的jar包后边加上-Xms和-Xmx参数,结果发现不起作用。"></a>最开始在需要启动的jar包后边加上-Xms和-Xmx参数,结果发现不起作用。</h3><h3 id="后来更改了启动命令"><a href="#后来更改了启动命令" class="headerlink" title="后来更改了启动命令"></a>后来更改了启动命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar -Xms512m -Xmx1024m $1 &amp;</span><br></pre></td></tr></table></figure>
<h3 id="如果将xms和xmx参数放在jar包后边则不会生效-只有放在jar包前边会生效"><a href="#如果将xms和xmx参数放在jar包后边则不会生效-只有放在jar包前边会生效" class="headerlink" title="如果将xms和xmx参数放在jar包后边则不会生效,只有放在jar包前边会生效"></a>如果将xms和xmx参数放在jar包后边则不会生效,只有放在jar包前边会生效</h3>
      
    </div>

    
    
    

   
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wodangminlong.github.io/2021/12/16/weight_random/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="dml">
      <meta itemprop="description" content="胜利垂青于有准备的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知足常乐">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/16/weight_random/" class="post-title-link" itemprop="url">Java实现权重随机算法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-12-16 18:06:57" itemprop="dateCreated datePublished" datetime="2021-12-16T18:06:57+08:00">2021-12-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-12-17 15:45:01" itemprop="dateModified" datetime="2021-12-17T15:45:01+08:00">2021-12-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java%E6%9D%83%E9%87%8D%E9%9A%8F%E6%9C%BA%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">java权重随机算法</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="本文参考了-权重随机算法的java实现-文章"><a href="#本文参考了-权重随机算法的java实现-文章" class="headerlink" title="本文参考了 权重随机算法的java实现]  文章"></a>本文参考了 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/waterystone/p/5708063.html">权重随机算法的java实现</a>]  文章</h3><h3 id="创建WeightRandom-java"><a href="#创建WeightRandom-java" class="headerlink" title="创建WeightRandom.java"></a>创建WeightRandom.java</h3><p>内容如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public class WeightRandom&lt;K,V extends Number&gt; &#123;</span><br><span class="line"></span><br><span class="line">    private final TreeMap&lt;Double, K&gt; weightMap = new TreeMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    public WeightRandom(List&lt;Pair&lt;K, V&gt;&gt; list) &#123;</span><br><span class="line">        list.forEach(kvPair -&gt; &#123;</span><br><span class="line">            double lastWeight = weightMap.size() == 0 ? 0 : weightMap.lastKey();</span><br><span class="line">            // 权重累加</span><br><span class="line">            weightMap.put(kvPair.getValue().doubleValue() + lastWeight, kvPair.getKey());</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public K random() &#123;</span><br><span class="line">        double randomWeight = weightMap.lastKey() * Math.random();</span><br><span class="line">        SortedMap&lt;Double, K&gt; tailMap = weightMap.tailMap(randomWeight, false);</span><br><span class="line">        return weightMap.get(tailMap.firstKey());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="新建WeightRandomTest-java"><a href="#新建WeightRandomTest-java" class="headerlink" title="新建WeightRandomTest.java"></a>新建WeightRandomTest.java</h3><p>内容如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">public class WeightRandomTest &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;Pair&lt;String, Integer&gt;&gt; list;</span><br><span class="line">    private WeightRandom&lt;String, Integer&gt; random;</span><br><span class="line"></span><br><span class="line">    public void random() &#123;</span><br><span class="line">        Map&lt;String, Integer&gt; countMap = new HashMap&lt;&gt;(6);</span><br><span class="line">        int num = 100000000;</span><br><span class="line">        IntStream.range(0,num).forEach(i -&gt; &#123;</span><br><span class="line">            String randomKey = random.random();</span><br><span class="line">            countMap.put(randomKey, countMap.getOrDefault(randomKey, 0) + 1);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        list.forEach(stringIntegerPair -&gt; &#123;</span><br><span class="line">            String key = stringIntegerPair.getKey();</span><br><span class="line">            Integer count = countMap.get(key);</span><br><span class="line">            BigDecimal i = BigDecimal.valueOf(count).divide(BigDecimal.valueOf(num), 10, RoundingMode.HALF_UP).multiply(BigDecimal.valueOf(100));</span><br><span class="line">            BigDecimal result = BigDecimal.valueOf(stringIntegerPair.getValue()).multiply(BigDecimal.valueOf(10));</span><br><span class="line">            BigDecimal s = result.subtract(i);</span><br><span class="line">            System.out.printf(&quot;%s: %s range: %s%s difference: %s;%n&quot;, key, count, i, &quot;%&quot;, s);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void init() &#123;</span><br><span class="line">        list = new ArrayList&lt;&gt;();</span><br><span class="line">        Pair&lt;String, Integer&gt; aPair = new Pair&lt;&gt;(&quot;A&quot;, 1);</span><br><span class="line">        Pair&lt;String, Integer&gt; bPair = new Pair&lt;&gt;(&quot;B&quot;, 2);</span><br><span class="line">        Pair&lt;String, Integer&gt; cPair = new Pair&lt;&gt;(&quot;C&quot;, 3);</span><br><span class="line">        Pair&lt;String, Integer&gt; dPair = new Pair&lt;&gt;(&quot;D&quot;, 4);</span><br><span class="line">        list.add(aPair);</span><br><span class="line">        list.add(bPair);</span><br><span class="line">        list.add(cPair);</span><br><span class="line">        list.add(dPair);</span><br><span class="line"></span><br><span class="line">        random = new WeightRandom&lt;&gt;(list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        long startTime = System.currentTimeMillis();</span><br><span class="line">        System.out.println(&quot;================start time: &quot; + startTime);</span><br><span class="line">        WeightRandomTest weightRandomTest = new WeightRandomTest();</span><br><span class="line">        weightRandomTest.init();</span><br><span class="line"></span><br><span class="line">        weightRandomTest.random();</span><br><span class="line">        System.out.println(&quot;================use time: &quot; + (System.currentTimeMillis() - startTime) + &quot; ms&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h3><table>
    <tr>
        <th colspan="6">1亿次随机测试</th>
    </tr>
    <tr>
        <th>权重key</th>
        <th>权重值</th>
        <th>命中结果</th>
        <th>命中百分比</th>
        <th>期望值</th>
        <th>误差</th>
    </tr>
    <tr>
        <td>A</td>
        <td>1</td>
        <td>9999275</td>
        <td>9.99927500%</td>
        <td>10%</td>
        <td>0.00072500%</td>
    </tr>
    <tr>
        <td>B</td>
        <td>2</td>
        <td>19998127</td>
        <td>19.99812700%</td>
        <td>20%</td>
        <td>0.00187300%</td>
    </tr>
    <tr>
        <td>C</td>
        <td>3</td>
        <td>30006723</td>
        <td>30.00672300%</td>
        <td>30%</td>
        <td>-0.00672300%</td>
    </tr>
    <tr>
        <td>D</td>
        <td>4</td>
        <td>39995875</td>
        <td>39.99587500%</td>
        <td>40%</td>
        <td>0.00412500%</td>
    </tr>
    
</table>
      
    </div>

    
    
    

   
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wodangminlong.github.io/2021/12/15/spring-ioc_cyclic_dependence/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="dml">
      <meta itemprop="description" content="胜利垂青于有准备的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知足常乐">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/15/spring-ioc_cyclic_dependence/" class="post-title-link" itemprop="url">SpringIOC如何解决循环依赖</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-12-15 10:14:55 / 修改时间：10:14:40" itemprop="dateCreated datePublished" datetime="2021-12-15T10:14:55+08:00">2021-12-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring-ioc/" itemprop="url" rel="index"><span itemprop="name">spring ioc</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring-ioc/spring-ioc-%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96/" itemprop="url" rel="index"><span itemprop="name">spring ioc 循环依赖</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="我们都知道Spring会解决对象之间的依赖-那么如果两个对象中有各自的相互依赖-Spring是如何解决这样的相互依赖的呢？"><a href="#我们都知道Spring会解决对象之间的依赖-那么如果两个对象中有各自的相互依赖-Spring是如何解决这样的相互依赖的呢？" class="headerlink" title="我们都知道Spring会解决对象之间的依赖,那么如果两个对象中有各自的相互依赖,Spring是如何解决这样的相互依赖的呢？"></a>我们都知道Spring会解决对象之间的依赖,那么如果两个对象中有各自的相互依赖,Spring是如何解决这样的相互依赖的呢？</h3><h3 id="SpringIOC通过三级缓存来解决循环依赖问题"><a href="#SpringIOC通过三级缓存来解决循环依赖问题" class="headerlink" title="SpringIOC通过三级缓存来解决循环依赖问题"></a>SpringIOC通过三级缓存来解决循环依赖问题</h3><h3 id="singletonObjects"><a href="#singletonObjects" class="headerlink" title="singletonObjects"></a>singletonObjects</h3><p>singletonObjects为一级缓存,单例缓存池,key为实例名称,value为实例对象</p>
<h3 id="earlySingletonObjects"><a href="#earlySingletonObjects" class="headerlink" title="earlySingletonObjects"></a>earlySingletonObjects</h3><p>earlySingletonObjects为二级缓存,早期对象,key为实例名称,value为实例对象,已经实例化但还没有进行属性注入的实例对象</p>
<h3 id="singletonFactories"><a href="#singletonFactories" class="headerlink" title="singletonFactories"></a>singletonFactories</h3><p>singletonFactories为三级缓存,key为实例名称,value为对象工厂(ObjectFactory)</p>
<p>在实际使用中,获取实例对象时先从一级缓存开始查询,没有再找二级缓存,再没有继续在三级缓存中查询。缓存实例对象的时候先从三级缓存开始,<br>再缓存到二级缓存,最后到一级缓存,缓存实例对象时三个缓存是互斥的,这样能保证同一个实例对象相同时间内只会缓存至其中的一个缓存中,并最终缓存至一级缓存中。</p>
<h3 id="创建实例-gt-缓存-gt-属性注入"><a href="#创建实例-gt-缓存-gt-属性注入" class="headerlink" title="创建实例-&gt;缓存-&gt;属性注入"></a>创建实例-&gt;缓存-&gt;属性注入</h3><p>当实例创建的时候,先将实例放入缓存,当循环依赖的对象都创建好了,再处理后续的属性注入。</p>
<h3 id="SpringIOC无法解决的循环依赖"><a href="#SpringIOC无法解决的循环依赖" class="headerlink" title="SpringIOC无法解决的循环依赖"></a>SpringIOC无法解决的循环依赖</h3><p>非单例对象,由于非单例对象不会缓存每次使用都会new一个。</p>
<p>通过构造器函数注入的循环依赖。</p>

      
    </div>

    
    
    

   
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wodangminlong.github.io/2021/12/14/spring-ioc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="dml">
      <meta itemprop="description" content="胜利垂青于有准备的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知足常乐">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/14/spring-ioc/" class="post-title-link" itemprop="url">SpringIOC基本原理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-12-14 16:46:46 / 修改时间：16:46:18" itemprop="dateCreated datePublished" datetime="2021-12-14T16:46:46+08:00">2021-12-14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index"><span itemprop="name">spring</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/spring-ioc/" itemprop="url" rel="index"><span itemprop="name">spring ioc</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="IOC容器的概念"><a href="#IOC容器的概念" class="headerlink" title="IOC容器的概念"></a>IOC容器的概念</h3><p>IOC容器就是具有依赖注入功能的容器,IOC容器负责实例化、定位、配置应用程序中的对象及建立这些对象之间的依赖。应用程序无需直接在代码中new相关的对象，<br>应用程序由IOC容器进行组装。<br>IOC容器管理对象之间的依赖关系,由IOC容器完成对象的注入,这样可以把复杂的对象依赖关系从应用中解放出来,简化了程序的开发过程。</p>
<h3 id="模拟IOC容器创建、注入"><a href="#模拟IOC容器创建、注入" class="headerlink" title="模拟IOC容器创建、注入"></a>模拟IOC容器创建、注入</h3><p>SpringIOCTest项目结构:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">SpringIOCTest:</span><br><span class="line">....</span><br><span class="line">java:</span><br><span class="line">  com:</span><br><span class="line">    config:</span><br><span class="line">      ConfigManager.java</span><br><span class="line">    context:</span><br><span class="line">      BeanFactory.java</span><br><span class="line">      ClassPathXmlApplicationContext.java</span><br><span class="line">    pojo:</span><br><span class="line">      Bean.java</span><br><span class="line">      Person.java</span><br><span class="line">      Property.java</span><br><span class="line">      Student.java</span><br><span class="line">      Teacher.java</span><br><span class="line">    Test.java  </span><br><span class="line">resources:</span><br><span class="line">  applicationContext.xml   </span><br><span class="line">....  </span><br><span class="line">pom.xml   </span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/12/14/spring-ioc/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

   
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wodangminlong.github.io/2021/12/10/centos-seata1.4.2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="dml">
      <meta itemprop="description" content="胜利垂青于有准备的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知足常乐">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/10/centos-seata1.4.2/" class="post-title-link" itemprop="url">Centos7安装Seata1.4.2服务端连接至Nacos</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-12-10 14:19:35 / 修改时间：14:19:18" itemprop="dateCreated datePublished" datetime="2021-12-10T14:19:35+08:00">2021-12-10</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/seata/" itemprop="url" rel="index"><span itemprop="name">seata</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/seata/seata1-4-2/" itemprop="url" rel="index"><span itemprop="name">seata1.4.2</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/seata/seata1-4-2/nacos/" itemprop="url" rel="index"><span itemprop="name">nacos</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="下载seata-server-1-4-2-zip包"><a href="#下载seata-server-1-4-2-zip包" class="headerlink" title="下载seata-server-1.4.2.zip包"></a>下载seata-server-1.4.2.zip包</h3><p>下载地址: <a target="_blank" rel="noopener" href="http://seata.io/zh-cn/blog/download.html">http://seata.io/zh-cn/blog/download.html</a></p>
<h3 id="上传至服务器-usr-local-目录下并解压"><a href="#上传至服务器-usr-local-目录下并解压" class="headerlink" title="上传至服务器/usr/local/ 目录下并解压"></a>上传至服务器/usr/local/ 目录下并解压</h3><p>解压命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># unzip seata-server-1.4.2.zip</span><br></pre></td></tr></table></figure>
<h3 id="修改file-conf文件"><a href="#修改file-conf文件" class="headerlink" title="修改file.conf文件"></a>修改file.conf文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># vim /usr/local/seata/seata-server-1.4.2/conf/file.conf</span><br></pre></td></tr></table></figure>
<p>最终内容如下:(这里以数据库地址127.0.0.1端口号3306,库名seata,账号密码root为例,根据实际情况更改)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">## transaction log store, only used in seata-server</span><br><span class="line">store &#123;</span><br><span class="line">  ## store mode: file、db、redis</span><br><span class="line">  mode = &quot;db&quot;</span><br><span class="line"></span><br><span class="line">  ## database store property</span><br><span class="line">  db &#123;</span><br><span class="line">    ## the implement of javax.sql.DataSource, such as DruidDataSource(druid)/BasicDataSource(dbcp)/HikariDataSource(hikari) etc.</span><br><span class="line">    datasource = &quot;druid&quot;</span><br><span class="line">    ## mysql/oracle/postgresql/h2/oceanbase etc.</span><br><span class="line">    dbType = &quot;mysql&quot;</span><br><span class="line">    driverClassName = &quot;com.mysql.cj.jdbc.Driver&quot;</span><br><span class="line">    ## if using mysql to store the data, recommend add rewriteBatchedStatements=true in jdbc connection param</span><br><span class="line">    url = &quot;jdbc:mysql://127.0.0.1:3306/seata?rewriteBatchedStatements=true&quot;</span><br><span class="line">    user = &quot;root&quot;</span><br><span class="line">    password = &quot;root&quot;</span><br><span class="line">    minConn = 5</span><br><span class="line">    maxConn = 100</span><br><span class="line">    globalTable = &quot;global_table&quot;</span><br><span class="line">    branchTable = &quot;branch_table&quot;</span><br><span class="line">    lockTable = &quot;lock_table&quot;</span><br><span class="line">    queryLimit = 100</span><br><span class="line">    maxWait = 5000</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/12/10/centos-seata1.4.2/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

   
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wodangminlong.github.io/2021/12/10/binarytree/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="dml">
      <meta itemprop="description" content="胜利垂青于有准备的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知足常乐">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/10/binarytree/" class="post-title-link" itemprop="url">BinaryTree二叉树</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-12-10 13:04:19 / 修改时间：13:03:57" itemprop="dateCreated datePublished" datetime="2021-12-10T13:04:19+08:00">2021-12-10</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/binary-tree/" itemprop="url" rel="index"><span itemprop="name">binary tree</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/binary-tree/%E4%BA%8C%E5%8F%89%E6%A0%91/" itemprop="url" rel="index"><span itemprop="name">二叉树</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="二叉树的定义"><a href="#二叉树的定义" class="headerlink" title="二叉树的定义"></a>二叉树的定义</h3><p>BinaryTree二叉树是树形结构的一个重要类型。许多实际问题抽象出来的数据往往是以二叉树形式,即使是一般的树也能简单的转换为二叉树,而且二叉树的存储结构和<br>算法都较为简单,因此二叉树显得特别重要。二叉树的特点是每个结点最多两个子结点,且有左右之分。 <br><br>二叉树是n个有限元素的集合,该集合或者为空,或者由一个成为根结点(root)及两个不相交的、被分别称为左子树和右子树的二叉树组成,是有序树。当集合为空时,称<br>该二叉树为空二叉树。在二叉树中,一个元素也称作一个结点。</p>
<h3 id="二叉树遍历"><a href="#二叉树遍历" class="headerlink" title="二叉树遍历"></a>二叉树遍历</h3><p>遍历是对树的一种最基本的运算,所谓遍历二叉树,就是按照一定的规则和顺序走遍二叉树所有结点,使每个结点都被访问一次,而且只被访问一次。由于二叉树是非线性<br>结构,因此树的遍历实际上是将二叉树的各个结点转换成一个线性序列来表示。</p>
<h3 id="JAVA递归方法遍历二叉树"><a href="#JAVA递归方法遍历二叉树" class="headerlink" title="JAVA递归方法遍历二叉树"></a>JAVA递归方法遍历二叉树</h3><p>创建TreeNode二叉树类</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class TreeNode &#123;</span><br><span class="line"></span><br><span class="line">    int value;</span><br><span class="line"></span><br><span class="line">    TreeNode leftNode;</span><br><span class="line">    TreeNode rightNode;</span><br><span class="line"></span><br><span class="line">    TreeNode(int value) &#123;</span><br><span class="line">        this.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>创建TreeNodeTest测试类</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">public class TreeNodeTest &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;Integer&gt; preorderResultList = new ArrayList&lt;&gt;();</span><br><span class="line">    List&lt;Integer&gt; mediumOrderResultList = new ArrayList&lt;&gt;();</span><br><span class="line">    List&lt;Integer&gt; postorderResultList = new ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 前序递归</span><br><span class="line">     *</span><br><span class="line">     * @param treeNode  treeNode</span><br><span class="line">     */</span><br><span class="line">    private void preorderRecursion(TreeNode treeNode) &#123;</span><br><span class="line">        preorderResultList.add(treeNode.value);</span><br><span class="line">        if (treeNode.leftNode != null) &#123;</span><br><span class="line">            preorderRecursion(treeNode.leftNode);</span><br><span class="line">        &#125;</span><br><span class="line">        if (treeNode.rightNode != null) &#123;</span><br><span class="line">            preorderRecursion(treeNode.rightNode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 中序递归</span><br><span class="line">     *</span><br><span class="line">     * @param treeNode  treeNode</span><br><span class="line">     */</span><br><span class="line">    private void mediumOrderRecursion(TreeNode treeNode) &#123;</span><br><span class="line">        if (treeNode.leftNode != null) &#123;</span><br><span class="line">            mediumOrderRecursion(treeNode.leftNode);</span><br><span class="line">        &#125;</span><br><span class="line">        mediumOrderResultList.add(treeNode.value);</span><br><span class="line">        if (treeNode.rightNode != null) &#123;</span><br><span class="line">            mediumOrderRecursion(treeNode.rightNode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 后序递归</span><br><span class="line">     *</span><br><span class="line">     * @param treeNode  treeNode</span><br><span class="line">     */</span><br><span class="line">    private void postorderRecursion(TreeNode treeNode) &#123;</span><br><span class="line">        if (treeNode.leftNode != null) &#123;</span><br><span class="line">            postorderRecursion(treeNode.leftNode);</span><br><span class="line">        &#125;</span><br><span class="line">        if (treeNode.rightNode != null) &#123;</span><br><span class="line">            postorderRecursion(treeNode.rightNode);</span><br><span class="line">        &#125;</span><br><span class="line">        postorderResultList.add(treeNode.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void print(int type) &#123;</span><br><span class="line">        switch (type) &#123;</span><br><span class="line">            case 1:</span><br><span class="line">                preorderResultList.forEach(System.out::println);</span><br><span class="line">                break;</span><br><span class="line">            case 2:</span><br><span class="line">                mediumOrderResultList.forEach(System.out::println);</span><br><span class="line">                break;</span><br><span class="line">            default:</span><br><span class="line">                postorderResultList.forEach(System.out::println);</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        TreeNode rootNode = new TreeNode(1);</span><br><span class="line">        TreeNode aNode = new TreeNode(2);</span><br><span class="line">        TreeNode bNode = new TreeNode(3);</span><br><span class="line">        TreeNode cNode = new TreeNode(4);</span><br><span class="line">        TreeNode dNode = new TreeNode(5);</span><br><span class="line">        TreeNode eNode = new TreeNode(6);</span><br><span class="line">        TreeNode fNode = new TreeNode(7);</span><br><span class="line">        TreeNode gNode = new TreeNode(8);</span><br><span class="line"></span><br><span class="line">        rootNode.leftNode = aNode;</span><br><span class="line">        rootNode.rightNode = bNode;</span><br><span class="line"></span><br><span class="line">        aNode.leftNode = cNode;</span><br><span class="line"></span><br><span class="line">        cNode.rightNode = fNode;</span><br><span class="line"></span><br><span class="line">        bNode.leftNode = dNode;</span><br><span class="line">        bNode.rightNode = eNode;</span><br><span class="line"></span><br><span class="line">        eNode.leftNode = gNode;</span><br><span class="line"></span><br><span class="line">        TreeNodeTest test = new TreeNodeTest();</span><br><span class="line"></span><br><span class="line">        // 前序递归</span><br><span class="line">        test.preorderRecursion(rootNode);</span><br><span class="line">        test.print(1);</span><br><span class="line"></span><br><span class="line">        // 中序递归</span><br><span class="line">        test.mediumOrderRecursion(rootNode);</span><br><span class="line">        test.print(2);</span><br><span class="line"></span><br><span class="line">        // 后序递归</span><br><span class="line">        test.postorderRecursion(rootNode);</span><br><span class="line">        test.print(3);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="前序递归遍历"><a href="#前序递归遍历" class="headerlink" title="前序递归遍历"></a>前序递归遍历</h3><p>先访问根结点,再访问左子结点,最后访问右子结点。</p>
<h3 id="中序递归遍历"><a href="#中序递归遍历" class="headerlink" title="中序递归遍历"></a>中序递归遍历</h3><p>先访问左子结点,再访问根结点,最后访问右子结点。</p>
<h3 id="后序递归遍历"><a href="#后序递归遍历" class="headerlink" title="后序递归遍历"></a>后序递归遍历</h3><p>先访问左子结点,再访问右子结点,最后访问根结点。</p>

      
    </div>

    
    
    

   
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wodangminlong.github.io/2021/12/09/mysql5.7.36charsetutf8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="dml">
      <meta itemprop="description" content="胜利垂青于有准备的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知足常乐">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/09/mysql5.7.36charsetutf8/" class="post-title-link" itemprop="url">mysql5.7.36中文乱码问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-12-09 16:46:17 / 修改时间：16:45:57" itemprop="dateCreated datePublished" datetime="2021-12-09T16:46:17+08:00">2021-12-09</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index"><span itemprop="name">mysql</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/mysql-%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">mysql 中文乱码问题</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="linux服务器安装mysql后发现出现中文乱码问题-解决方案为修改my-cnf"><a href="#linux服务器安装mysql后发现出现中文乱码问题-解决方案为修改my-cnf" class="headerlink" title="linux服务器安装mysql后发现出现中文乱码问题,解决方案为修改my.cnf"></a>linux服务器安装mysql后发现出现中文乱码问题,解决方案为修改my.cnf</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># vim /etc/my.cnf</span><br></pre></td></tr></table></figure>
<h3 id="在最后一行新增character-set-server-utf8"><a href="#在最后一行新增character-set-server-utf8" class="headerlink" title="在最后一行新增character-set-server=utf8"></a>在最后一行新增character-set-server=utf8</h3><h3 id="如果旧项目中出现表-字段-视图大小写与实际不匹配时-可以更改my-cnf"><a href="#如果旧项目中出现表-字段-视图大小写与实际不匹配时-可以更改my-cnf" class="headerlink" title="如果旧项目中出现表/字段/视图大小写与实际不匹配时,可以更改my.cnf"></a>如果旧项目中出现表/字段/视图大小写与实际不匹配时,可以更改my.cnf</h3><h3 id="在最后一行新增lower-case-table-names-1"><a href="#在最后一行新增lower-case-table-names-1" class="headerlink" title="在最后一行新增lower_case_table_names=1"></a>在最后一行新增lower_case_table_names=1</h3><p>lower_case_table_names=1表示不校验大小写,为0时校验大小写</p>
<h3 id="如果出现STR-TO-DATE为null或”this-is-incompatible-with-sql-mode-only-full-group-by”的情况-可以更改my-cnf"><a href="#如果出现STR-TO-DATE为null或”this-is-incompatible-with-sql-mode-only-full-group-by”的情况-可以更改my-cnf" class="headerlink" title="如果出现STR_TO_DATE为null或”this is incompatible with sql_mode=only_full_group_by”的情况,可以更改my.cnf"></a>如果出现STR_TO_DATE为null或”this is incompatible with sql_mode=only_full_group_by”的情况,可以更改my.cnf</h3><h3 id="在最后一行新增sql-mode-’STRICT-TRANS-TABLES’"><a href="#在最后一行新增sql-mode-’STRICT-TRANS-TABLES’" class="headerlink" title="在最后一行新增sql_mode=’STRICT_TRANS_TABLES’"></a>在最后一行新增sql_mode=’STRICT_TRANS_TABLES’</h3><p>这样把sql_mode中的NO_ZERO_IN_DATE和NO_ZERO_DATE去掉就可以了</p>
<h3 id="最重要还是代码和sql规范编写"><a href="#最重要还是代码和sql规范编写" class="headerlink" title="最重要还是代码和sql规范编写"></a>最重要还是代码和sql规范编写</h3>
      
    </div>

    
    
    

   
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wodangminlong.github.io/2021/12/08/spring-aspect_redis_lock/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="dml">
      <meta itemprop="description" content="胜利垂青于有准备的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知足常乐">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/08/spring-aspect_redis_lock/" class="post-title-link" itemprop="url">Spring使用aspect进行切面编程之RedisLock分布式锁</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-12-08 10:41:25 / 修改时间：10:41:11" itemprop="dateCreated datePublished" datetime="2021-12-08T10:41:25+08:00">2021-12-08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index"><span itemprop="name">spring</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/spring-aspect-redis-lock/" itemprop="url" rel="index"><span itemprop="name">spring aspect redis lock</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="利用spring-AOP切面编程创建和使用Redis分布式锁"><a href="#利用spring-AOP切面编程创建和使用Redis分布式锁" class="headerlink" title="利用spring AOP切面编程创建和使用Redis分布式锁"></a>利用spring AOP切面编程创建和使用Redis分布式锁</h3><h3 id="创建RedisLock自定义注解类"><a href="#创建RedisLock自定义注解类" class="headerlink" title="创建RedisLock自定义注解类"></a>创建RedisLock自定义注解类</h3><p>内容如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@Target(&#123;ElementType.METHOD&#125;)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">public @interface RedisLock &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * lock key</span><br><span class="line">     * @return  string</span><br><span class="line">     */</span><br><span class="line">    String lockKey() default Constant.DEFAULT_ORDER_LOCK_KEY_PREFIX;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * expire time</span><br><span class="line">     * @return time</span><br><span class="line">     */</span><br><span class="line">    long timeout() default Constant.DEFAULT_ORDER_LOCK_TIME;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>lockKey和timeout属性可以自定义内容</p>
<h3 id="创建RedisLockAspect类"><a href="#创建RedisLockAspect类" class="headerlink" title="创建RedisLockAspect类"></a>创建RedisLockAspect类</h3><p>内容如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">@Slf4j</span><br><span class="line">@Aspect</span><br><span class="line">@Component</span><br><span class="line">public class RedisLockAspect &#123;</span><br><span class="line"></span><br><span class="line">    @Resource</span><br><span class="line">    private RedisUtils redisUtils;</span><br><span class="line"></span><br><span class="line">    ThreadLocal&lt;Long&gt; currentTime = new ThreadLocal&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    @Pointcut(&quot;@annotation(redisLock)&quot;)</span><br><span class="line">    public void pointCut(RedisLock redisLock) &#123;</span><br><span class="line">        // do something</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Around(value = &quot;pointCut(redisLock)&quot;, argNames = &quot;proceedingJoinPoint,redisLock&quot;)</span><br><span class="line">    public Object around(ProceedingJoinPoint proceedingJoinPoint, RedisLock redisLock) throws Throwable &#123;</span><br><span class="line">        currentTime.set(System.currentTimeMillis());</span><br><span class="line">        String lockKey = redisLock.lockKey();</span><br><span class="line">        long timeout = redisLock.timeout();</span><br><span class="line">        try &#123;</span><br><span class="line">            for (; ; ) &#123;</span><br><span class="line">                // try to get lock</span><br><span class="line">                boolean getLock = redisUtils.lock(lockKey, lockKey, timeout);</span><br><span class="line">                if (getLock) &#123;</span><br><span class="line">                    MethodSignature signature = (MethodSignature) proceedingJoinPoint.getSignature();</span><br><span class="line">                    log.info(&quot;&#123;&#125;.&#123;&#125; get lock&quot;, proceedingJoinPoint.getTarget().getClass().getName(), signature.getName());</span><br><span class="line">                    currentTime.remove();</span><br><span class="line">                    return proceedingJoinPoint.proceed();</span><br><span class="line">                &#125;</span><br><span class="line">                long end = System.currentTimeMillis() - currentTime.get();</span><br><span class="line">                if (end &gt;= timeout) &#123;</span><br><span class="line">                    currentTime.remove();</span><br><span class="line">                    return ApiResponse.error(ApiErrorCode.OPERATION_IS_TOO_FREQUENT);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            redisUtils.releaseLock(lockKey);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="核心方法在环绕通知方法里边-获取到锁之后调用proceedingJoinPoint-proceed-方法让目标方法执行"><a href="#核心方法在环绕通知方法里边-获取到锁之后调用proceedingJoinPoint-proceed-方法让目标方法执行" class="headerlink" title="核心方法在环绕通知方法里边,获取到锁之后调用proceedingJoinPoint.proceed()方法让目标方法执行"></a>核心方法在环绕通知方法里边,获取到锁之后调用proceedingJoinPoint.proceed()方法让目标方法执行</h3><h3 id="在接口上加-RedisLock注解"><a href="#在接口上加-RedisLock注解" class="headerlink" title="在接口上加@RedisLock注解"></a>在接口上加@RedisLock注解</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Log(&quot;测试接口&quot;)</span><br><span class="line">@RedisLock</span><br><span class="line">@GetMapping(&quot;test&quot;)</span><br><span class="line">public String test() &#123;</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="使用Jmeter试试并发情况"><a href="#使用Jmeter试试并发情况" class="headerlink" title="使用Jmeter试试并发情况"></a>使用Jmeter试试并发情况</h3>
      
    </div>

    
    
    

   
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wodangminlong.github.io/2021/12/07/spring-transactional/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="dml">
      <meta itemprop="description" content="胜利垂青于有准备的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知足常乐">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/07/spring-transactional/" class="post-title-link" itemprop="url">Spring中的Transactional</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-12-07 16:49:53 / 修改时间：16:49:40" itemprop="dateCreated datePublished" datetime="2021-12-07T16:49:53+08:00">2021-12-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index"><span itemprop="name">spring</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/spring-transactional/" itemprop="url" rel="index"><span itemprop="name">spring transactional</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Spring的事务管理方式有两种-1-编程式2-声明式。"><a href="#Spring的事务管理方式有两种-1-编程式2-声明式。" class="headerlink" title="Spring的事务管理方式有两种,1.编程式2.声明式。"></a>Spring的事务管理方式有两种,1.编程式2.声明式。</h3><h3 id="1-编程式事务是通过编码方式实现事务"><a href="#1-编程式事务是通过编码方式实现事务" class="headerlink" title="1.编程式事务是通过编码方式实现事务"></a>1.编程式事务是通过编码方式实现事务</h3><h3 id="2-声明式事务基于AOP-可以使业务代码和事务处理解耦-在实际使用中声明式事务用的比较多"><a href="#2-声明式事务基于AOP-可以使业务代码和事务处理解耦-在实际使用中声明式事务用的比较多" class="headerlink" title="2.声明式事务基于AOP,可以使业务代码和事务处理解耦,在实际使用中声明式事务用的比较多"></a>2.声明式事务基于AOP,可以使业务代码和事务处理解耦,在实际使用中声明式事务用的比较多</h3><h3 id="在Springboot中使用Transactional"><a href="#在Springboot中使用Transactional" class="headerlink" title="在Springboot中使用Transactional"></a>在Springboot中使用Transactional</h3><p>直接在需要增加的事务方法上加@Transactional注解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Transactional</span><br><span class="line">public int testAdd() &#123;</span><br><span class="line">    // do smoething</span><br><span class="line">    return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Springboot在启动时会使用DataSourceTransactionManagerAutoConfiguration配置一个事务管理器DataSourceTransactionManager"><a href="#Springboot在启动时会使用DataSourceTransactionManagerAutoConfiguration配置一个事务管理器DataSourceTransactionManager" class="headerlink" title="Springboot在启动时会使用DataSourceTransactionManagerAutoConfiguration配置一个事务管理器DataSourceTransactionManager"></a>Springboot在启动时会使用DataSourceTransactionManagerAutoConfiguration配置一个事务管理器DataSourceTransactionManager</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@ConditionalOnSingleCandidate(DataSource.class)</span><br><span class="line">static class JdbcTransactionManagerConfiguration &#123;</span><br><span class="line">    JdbcTransactionManagerConfiguration() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    @ConditionalOnMissingBean(&#123;TransactionManager.class&#125;)</span><br><span class="line">    DataSourceTransactionManager transactionManager(Environment environment, DataSource dataSource, ObjectProvider&lt;TransactionManagerCustomizers&gt; transactionManagerCustomizers) &#123;</span><br><span class="line">        DataSourceTransactionManager transactionManager = this.createTransactionManager(environment, dataSource);</span><br><span class="line">        transactionManagerCustomizers.ifAvailable((customizers) -&gt; &#123;</span><br><span class="line">            customizers.customize(transactionManager);</span><br><span class="line">        &#125;);</span><br><span class="line">        return transactionManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private DataSourceTransactionManager createTransactionManager(Environment environment, DataSource dataSource) &#123;</span><br><span class="line">        return (DataSourceTransactionManager)((Boolean)environment.getProperty(&quot;spring.dao.exceptiontranslation.enabled&quot;, Boolean.class, Boolean.TRUE) ? new JdbcTransactionManager(dataSource) : new DataSourceTransactionManager(dataSource));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/12/07/spring-transactional/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

   
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://wodangminlong.github.io/2021/12/07/spring-aspect_log/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="dml">
      <meta itemprop="description" content="胜利垂青于有准备的人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知足常乐">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/07/spring-aspect_log/" class="post-title-link" itemprop="url">Spring使用aspect进行切面编程之log</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-12-07 11:49:47 / 修改时间：11:43:48" itemprop="dateCreated datePublished" datetime="2021-12-07T11:49:47+08:00">2021-12-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/" itemprop="url" rel="index"><span itemprop="name">spring</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring/spring-aspect-log/" itemprop="url" rel="index"><span itemprop="name">spring aspect log</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="系统需要记录用户的操作记录-如果每个接口都加一个addLog方法也是可以的-但显然这样的工作量是很大的-有没有一种更简便的方案呢？"><a href="#系统需要记录用户的操作记录-如果每个接口都加一个addLog方法也是可以的-但显然这样的工作量是很大的-有没有一种更简便的方案呢？" class="headerlink" title="系统需要记录用户的操作记录,如果每个接口都加一个addLog方法也是可以的,但显然这样的工作量是很大的,有没有一种更简便的方案呢？"></a>系统需要记录用户的操作记录,如果每个接口都加一个addLog方法也是可以的,但显然这样的工作量是很大的,有没有一种更简便的方案呢？</h3><h3 id="有-使用Spring-AOP核心思想创建一个自定义切面注解-在每个接口上加一个注解-既节省了工作量也没有破坏原有的接口业务逻辑。"><a href="#有-使用Spring-AOP核心思想创建一个自定义切面注解-在每个接口上加一个注解-既节省了工作量也没有破坏原有的接口业务逻辑。" class="headerlink" title="有,使用Spring AOP核心思想创建一个自定义切面注解,在每个接口上加一个注解,既节省了工作量也没有破坏原有的接口业务逻辑。"></a>有,使用Spring AOP核心思想创建一个自定义切面注解,在每个接口上加一个注解,既节省了工作量也没有破坏原有的接口业务逻辑。</h3><h3 id="创建Log自定义注解类"><a href="#创建Log自定义注解类" class="headerlink" title="创建Log自定义注解类"></a>创建Log自定义注解类</h3><p>内容如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Target(&#123;ElementType.METHOD&#125;)</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="line">public @interface Log &#123;</span><br><span class="line"></span><br><span class="line">    String value() default &quot;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="创建LogAspect类"><a href="#创建LogAspect类" class="headerlink" title="创建LogAspect类"></a>创建LogAspect类</h3><p>内容如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">@Slf4j</span><br><span class="line">@Aspect</span><br><span class="line">@Component</span><br><span class="line">public class LogAspect &#123;</span><br><span class="line"></span><br><span class="line">    ThreadLocal&lt;Long&gt; currentTime = new ThreadLocal&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    private final SystemLogService systemLogService;</span><br><span class="line"></span><br><span class="line">    public LogAspect(SystemLogService systemLogService) &#123;</span><br><span class="line">        this.systemLogService = systemLogService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Pointcut(&quot;@annotation(Log)&quot;)</span><br><span class="line">    public void logPointcut() &#123;</span><br><span class="line">        // do something</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Around(&quot;logPointcut()&quot;)</span><br><span class="line">    public Object around(ProceedingJoinPoint pjp) throws Throwable &#123;</span><br><span class="line">        Object result;</span><br><span class="line">        currentTime.set(System.currentTimeMillis());</span><br><span class="line">        result = pjp.proceed();</span><br><span class="line">        SystemLog systemLog = getSystemLog(pjp, &quot;&quot;);</span><br><span class="line">        currentTime.remove();</span><br><span class="line">        systemLogService.addLog(systemLog);</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 配置异常通知</span><br><span class="line">     *</span><br><span class="line">     * @param joinPoint join point for advice</span><br><span class="line">     * @param e exception</span><br><span class="line">     */</span><br><span class="line">    @AfterThrowing(pointcut = &quot;logPointcut()&quot;, throwing = &quot;e&quot;)</span><br><span class="line">    public void logAfterThrowing(JoinPoint joinPoint, Throwable e) &#123;</span><br><span class="line">        ProceedingJoinPoint pjp = (ProceedingJoinPoint)joinPoint;</span><br><span class="line">        SystemLog systemLog = getSystemLog(pjp, e.getMessage());</span><br><span class="line">        currentTime.remove();</span><br><span class="line">        systemLogService.addLog(systemLog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private SystemLog getSystemLog(ProceedingJoinPoint pjp, String e) &#123;</span><br><span class="line">        SystemLog systemLog = new SystemLog();</span><br><span class="line">        MethodSignature signature = (MethodSignature) pjp.getSignature();</span><br><span class="line">        Method method = signature.getMethod();</span><br><span class="line">        Log l = method.getAnnotation(Log.class);</span><br><span class="line">        HttpServletRequest request = getHttpServletRequest();</span><br><span class="line">        String ip = IpUtils.getIpAddress(request);</span><br><span class="line">        String address = getAddress(ip);</span><br><span class="line">        String browser = getBrowser(request);</span><br><span class="line">        String systemName = getSystemName(request);</span><br><span class="line">        systemLog.setRemark(l.value())</span><br><span class="line">                .setLogType(getLogLevel())</span><br><span class="line">                .setMethod(pjp.getTarget().getClass().getName()+&quot;.&quot;+signature.getName())</span><br><span class="line">                .setParams(JSON.toJSONString(pjp.getArgs()))</span><br><span class="line">                .setRequestIp(ip)</span><br><span class="line">                .setDuration(System.currentTimeMillis() - currentTime.get())</span><br><span class="line">                .setUsername(&quot;admin&quot;)</span><br><span class="line">                .setAddress(address)</span><br><span class="line">                .setBrowser(browser)</span><br><span class="line">                .setSystemName(systemName)</span><br><span class="line">                .setError(e)</span><br><span class="line">                .setCreateTime(LocalDateTime.now());</span><br><span class="line">        return systemLog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private HttpServletRequest getHttpServletRequest() &#123;</span><br><span class="line">        return ((ServletRequestAttributes) Objects.requireNonNull(RequestContextHolder.getRequestAttributes())).getRequest();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private String getLogLevel() &#123;</span><br><span class="line">        if (log.isDebugEnabled()) &#123;</span><br><span class="line">            return &quot;DEBUG&quot;;</span><br><span class="line">        &#125; else if (log.isInfoEnabled()) &#123;</span><br><span class="line">            return &quot;INFO&quot;;</span><br><span class="line">        &#125; else if (log.isWarnEnabled()) &#123;</span><br><span class="line">            return &quot;WARN&quot;;</span><br><span class="line">        &#125; else if (log.isErrorEnabled()) &#123;</span><br><span class="line">            return &quot;ERROR&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        return &quot;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private String getAddress(String ip) &#123;</span><br><span class="line">        String api = String.format(&quot;https://whois.pconline.com.cn/ipJson.jsp?ip=%s&amp;json=true&quot;, ip);</span><br><span class="line">        RestTemplate restTemplate = new RestTemplate();</span><br><span class="line">        String result = restTemplate.getForEntity(api, String.class).getBody();</span><br><span class="line">        return JSON.parseObject(result).getString(&quot;addr&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private String getBrowser(HttpServletRequest request) &#123;</span><br><span class="line">        UserAgent userAgent = UserAgent.parseUserAgentString(request.getHeader(&quot;User-Agent&quot;));</span><br><span class="line">        Browser browser = userAgent.getBrowser();</span><br><span class="line">        return browser.getName();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private String getSystemName(HttpServletRequest request) &#123;</span><br><span class="line">        UserAgent userAgent = UserAgent.parseUserAgentString(request.getHeader(&quot;User-Agent&quot;));</span><br><span class="line">        OperatingSystem operatingSystem = userAgent.getOperatingSystem();</span><br><span class="line">        return operatingSystem.getName();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="systemLogService-addLog-systemLog-方法只是写入数据库-这里就不贴代码了"><a href="#systemLogService-addLog-systemLog-方法只是写入数据库-这里就不贴代码了" class="headerlink" title="systemLogService.addLog(systemLog) 方法只是写入数据库,这里就不贴代码了"></a>systemLogService.addLog(systemLog) 方法只是写入数据库,这里就不贴代码了</h3><h3 id="在接口上加-Log注解"><a href="#在接口上加-Log注解" class="headerlink" title="在接口上加@Log注解"></a>在接口上加@Log注解</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Log(&quot;测试接口&quot;)</span><br><span class="line">@GetMapping(&quot;test&quot;)</span><br><span class="line">public String test() &#123;</span><br><span class="line">    return &quot;success&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="使用浏览器调用test接口试试"><a href="#使用浏览器调用test接口试试" class="headerlink" title="使用浏览器调用test接口试试"></a>使用浏览器调用test接口试试</h3>
      
    </div>

    
    
    

   
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="dml"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">dml</p>
  <div class="site-description" itemprop="description">胜利垂青于有准备的人</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">52</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">65</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">dml</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>



<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共25.2k字</span>
</div>
<a target="_blank" rel="noopener" href="https://info.flagcounter.com/n7Pv"><img src="https://s11.flagcounter.com/map/n7Pv/size_s/txt_000000/border_CCCCCC/pageviews_0/viewers_0/flags_0/" alt="Flag Counter" border="0"></a>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>


  















  

  


</body>
</html>
